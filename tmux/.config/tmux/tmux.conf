# ~/.tmux.conf

# Change prefix from C-b to C-a (or keep C-b if you prefer)
set -g prefix C-a
unbind C-b
bind-key C-a send-prefix

# Enable mouse support
set -g mouse on

# Start windows and panes at 1, not 0
set -g base-index 1
setw -g pane-base-index 1

# Renumber windows when a window is closed
set -g renumber-windows on

# Enable 256 colors and true color support (important for Neovim)
set -g default-terminal "screen-256color"
set -ga terminal-overrides ",*256col*:Tc"

# Faster command sequences (eliminates delays)
set -s escape-time 0

# Increase scrollback buffer size
set -g history-limit 50000

# Display messages for a bit longer
set -g display-time 4000

# Refresh status more often
set -g status-interval 5

# Move status line to top
set-option -g status-position top

# Vi mode for copy mode (works great with Neovim muscle memory)
setw -g mode-keys vi
bind-key -T copy-mode-vi v send-keys -X begin-selection
bind-key -T copy-mode-vi y send-keys -X copy-selection-and-cancel

# Better pane splitting
bind | split-window -h -c "#{pane_current_path}"
bind - split-window -v -c "#{pane_current_path}"

# Smart pane switching with awareness of Neovim splits
is_vim="ps -o state= -o comm= -t '#{pane_tty}' \
    | grep -iqE '^[^TXZ ]+ +(\\S+\\/)?g?(view|n?vim?x?)(diff)?$'"
bind-key -n 'C-h' if-shell "$is_vim" 'send-keys C-h'  'select-pane -L'
bind-key -n 'C-j' if-shell "$is_vim" 'send-keys C-j'  'select-pane -D'
bind-key -n 'C-k' if-shell "$is_vim" 'send-keys C-k'  'select-pane -U'
bind-key -n 'C-l' if-shell "$is_vim" 'send-keys C-l'  'select-pane -R'

# Pane resizing
bind -r H resize-pane -L 5
bind -r J resize-pane -D 5
bind -r K resize-pane -U 5
bind -r L resize-pane -R 5

# List of plugins
set -g @plugin 'tmux-plugins/tpm'
set -g @plugin 'tmux-plugins/tmux-sensible'
set -g @plugin 'catppuccin/tmux'
set -g @plugin 'tmux-plugins/tmux-cpu'
set -g @plugin 'tmux-plugins/tmux-battery'

# Catppuccin theme configuration (frappe to match Neovim)
set -g @catppuccin_flavour 'frappe' # latte, frappe, macchiato, mocha


# Status bar configuration
set -g status-left ""
set -g status-right ""
set -g status-left-length 100
set -g status-right-length 100

# Window configuration - show directory path in window tabs
set -g @catppuccin_window_left_separator ""
set -g @catppuccin_window_right_separator " "
set -g @catppuccin_window_middle_separator " "
set -g @catppuccin_window_number_position "left"
set -g @catppuccin_window_default_fill "number"
set -g @catppuccin_window_current_fill "number"

# Show directory name in window tabs
set -g @catppuccin_window_default_text "#{b:pane_current_path}"
set -g @catppuccin_window_current_text "#{b:pane_current_path}"

# Configure status modules - matches the image layout
set -g @catppuccin_status_modules_left "directory"
set -g @catppuccin_status_modules_right "application cpu date_time battery"

# Module configurations
set -g @catppuccin_status_left_separator  " "
set -g @catppuccin_status_right_separator " "
set -g @catppuccin_status_connect_separator "no"
set -g @catppuccin_status_fill "icon"

# Configure individual modules
set -g @catppuccin_directory_text "#{pane_current_path}"
set -g @catppuccin_application_text "#{pane_current_command}"
set -g @catppuccin_date_time_text "%I:%M%p"

# Icon configuration (requires Nerd Font)
set -g @catppuccin_directory_icon ""
set -g @catppuccin_application_icon ""
set -g @catppuccin_cpu_icon "󰍛"
set -g @catppuccin_date_time_icon "󱑍"
set -g @catppuccin_battery_icon "󰁹"

# Initialize TMUX plugin manager (keep this line at the very bottom of tmux.conf)
run '~/.tmux/plugins/tpm/tpm'